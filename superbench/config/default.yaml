# SuperBench Config
superbench:
  enable: null
  benchmarks:
    kernel-launch:
      enable: true
      modes: &local_mode_config
        - name: local
          proc_num: 8
          prefix: CUDA_VISIBLE_DEVICES={proc_rank}
          parallel: yes
    gemm-flops:
      enable: true
      modes: *local_mode_config
    cudnn-function:
      enable: true
      modes: *local_mode_config
    cublas-function:
      enable: true
      modes: *local_mode_config
    matmul:
      enable: true
      modes: *local_mode_config
      frameworks:
        - pytorch
    sharding-matmul:
      enable: true
      modes: &pytorch_mode_config
        - name: torch.distributed
          proc_num: 8
          node_num: 1
      frameworks:
        - pytorch
    computation-communication-overlap:
      enable: true
      modes: *pytorch_mode_config
      frameworks:
        - pytorch
    gpt_models:
      enable: true
      modes: *pytorch_mode_config
      frameworks:
        - pytorch
      models:
        - gpt2-small
        - gpt2-large
      parameters:
        duration: 0
        num_warmup: 16
        num_steps: 128
        batch_size: 4
        precision:
          - float32
          - float16
        model_action:
          - train
    bert_models:
      enable: true
      modes: *pytorch_mode_config
      frameworks:
        - pytorch
      models:
        - bert-base
        - bert-large
      parameters:
        duration: 0
        num_warmup: 16
        num_steps: 128
        batch_size: 8
        precision:
          - float32
          - float16
        model_action:
          - train
    lstm_models:
      enable: true
      modes: *pytorch_mode_config
      frameworks:
        - pytorch
      models:
        - lstm
      parameters:
        duration: 0
        num_warmup: 16
        num_steps: 128
        batch_size: 128
        precision:
          - float32
          - float16
        model_action:
          - train
    cnn_models:
      enable: true
      modes: *pytorch_mode_config
      frameworks:
        - pytorch
      models:
        - resnet50
        - resnet101
        - resnet152
        - densenet169
        - densenet201
        - vgg11
        - vgg13
        - vgg16
        - vgg19
      parameters:
        duration: 0
        num_warmup: 16
        num_steps: 128
        batch_size: 128
        precision:
          - float32
          - float16
        model_action:
          - train
